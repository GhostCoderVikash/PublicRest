<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Call to Salesforce (Public)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
    </style>
</head>
<body>
    <h1>API Call to Salesforce (Public)</h1>

    <script>
        window.onload = function() {
            fetchApiData();
        };

        async function fetchApiData() {
            const apiEndpoint = `https://resourceful-fox-a2o4pb-dev-ed.trailblaze.my.site.com/services/apexrest/miawSiteConfigAPI?url=https://ghostcodervikash.github.io/demo`;

            // Log the initial API endpoint
            console.log("Calling API with endpoint:", apiEndpoint);

            try {
                // Making the GET request to the Salesforce API
                const response = await fetch(apiEndpoint, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/xml' // Expecting XML response
                    }
                });

                // Log the response status
                console.log("Response Status:", response.status);

                if (!response.ok) {
                    throw new Error('Failed to fetch data');
                }

                // Get the response text (XML format)
                const responseText = await response.text();

                // Parse the XML response
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(responseText, "application/xml");

                // Extract the data, handling the namespace
                const ns = "http://soap.sforce.com/schemas/class/MiawSiteConfigAPI";
                const URL = xmlDoc.getElementsByTagNameNS(ns, "URL")[0].textContent;
                const message = xmlDoc.getElementsByTagNameNS(ns, "message")[0].textContent;
                const Language = xmlDoc.getElementsByTagNameNS(ns, "Language")[0].textContent;
                const BusinessStartTime = xmlDoc.getElementsByTagNameNS(ns, "Business_Start_Time")[0].textContent;
                const BusinessEndTime = xmlDoc.getElementsByTagNameNS(ns, "Business_End_Time")[0].textContent;

                // Log each field separately
                console.log("URL:", URL);
                console.log("Message:", message);
                console.log("Language:", Language);
                console.log("Business Start Time:", BusinessStartTime);
                console.log("Business End Time:", BusinessEndTime);

            } catch (error) {
                // Log the error
                console.log("Error:", error.message);
            }
        }
    </script>
</body>
</html>
